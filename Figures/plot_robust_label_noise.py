import matplotlib.pyplot as plt


plt.rcParams['font.family'] = 'Times New Roman'
# 假设有4个模型，噪声率范围如下：
noise_rates = [0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4]
models = ['GBkNN', 'ACC-GBkNN', 'ADP-GBkNN','GBkNN++' 'SGBkNN']
markers = ['o', '^', 'x', 's', 'D']  # 不同模型使用不同的符号
colors = [ '#4DBBD5', '#00A087', '#3C5488','#3A5F9B','r']
# colors = ['#FFB347', '#77DD77', '#FF6961', '#3A5F9B']  # 使用不同的颜色

# 手动定义每个模型在不同噪声率下的准确率
accuracies = {
    ##echocardiogram
    "Dataset 1": {
        "GBkNN":     [0.9667, 0.9333 ,  0.9000 ,   0.8167 , 0.7500 ,  0.7167 ,  0.6500 , 0.6667 , 0.7000 ],
        "ACC-GBkNN": [0.9167, 0.9167 ,  0.8667 ,   0.8833 , 0.8500 ,  0.7833 ,  0.7667 , 0.6667 , 0.6333 ],
        "ADP-GBkNN": [0.9000, 0.9000 ,  0.8333 ,   0.8333 , 0.7167 ,  0.7500 ,  0.6833 , 0.6000,  0.6833 ],
        "GBkNN++"  : [0.9667, 0.9167 ,  0.9000 ,   0.8833  ,0.8500  ,0.8667  ,0.6667  ,0.6500  ,0.6333 ],
        "SGBkNN":    [0.9833, 0.9333 ,  0.9333 ,   0.8667 , 0.8333 ,  0.7833 ,  0.8167 , 0.7833 , 0.6333 ]
    },
    ## Iris
    "Dataset 2": {
        "GBkNN":     [0.8986, 0.8400  , 0.8062  , 0.8590  , 0.7114  , 0.6848  , 0.6457  , 0.6114  , 0.6105  ],
        "ACC-GBkNN": [0.9457, 0.9467  , 0.9262  , 0.8924  , 0.8386  , 0.8457  , 0.6852  , 0.6376  , 0.6714  ],
        "ADP-GBkNN": [0.9595, 0.9467  , 0.9195  , 0.8929  , 0.8119  , 0.7857  , 0.6652  , 0.6576  , 0.6248  ],
        "GBkNN++"  : [0.9395, 0.9533 ,   0.9333 , 0.9333 ,  0.8600 ,  0.8933 ,  0.8067,   0.7733 ,0.7133 ],
        "SGBkNN":    [0.9733, 0.9600  , 0.9395  , 0.9533  , 0.9329  , 0.9195  , 0.9067  , 0.8662  , 0.8390  ]
    },
    ## parkinsons
    "Dataset 3": {
        "GBkNN":     [0.8403, 0.8516 	,
0.8463 	,
0.8000 	,
0.7282 	,
0.7111 	,
0.7187 	,
0.6663 	,
0.5634 	, ],
        "ACC-GBkNN": [0.8100, 0.8355 	,
0.8311 	,
0.7592 	,
0.7592 	,
0.6858 	,
0.6826 	,
0.6342 	,
0.5534 	  ],
        "ADP-GBkNN": [0.8103, 0.8516 	,
0.8463 	,
0.8000 	,
0.7282 	,
0.7111 	,
0.7187 	,
0.6663 	,
0.5634 	,],
        "GBkNN++"  : [0.8363, 0.8005 	,
0.8308 	,
0.8045 	,
0.7897 	,
0.7171 	,
0.6826 	,
0.6766 	,
0.5942 	,],
        "SGBkNN":    [0.8671, 0.8466 	,
0.8363 	,
0.8011 	,
0.8155 	,
0.7545 	,
0.7858 	,
0.6874 	,
0.6474 	,  ]
    },
    ## seeds
    "Dataset 4": {
        "GBkNN":     [0.7000, 0.6476 	,
0.6095 	,
0.6048 	,
0.6286 	,
0.5952 	,
0.5238 	,
0.4190 	,
0.5048 	, ],
        "ACC-GBkNN": [0.8667, 0.8524 	,
0.8238 	,
0.7905 	,
0.7714 	,
0.7095 	,
0.6619 	,
0.6667 	,
0.6429 	,  ],
        "ADP-GBkNN": [0.8762, 0.8571 	,
0.8095 	,
0.7857 	,
0.7571 	,
0.7000 	,
0.6857 	,
0.6714 	,
0.6429 	,  ],
        "GBkNN++"  : [0.8857, 0.8619 	,
0.8476 	,
0.8286 	,
0.7905 	,
0.8095 	,
0.7714 	,
0.7048 	,
0.7333 	,],
        "SGBkNN":    [0.9000 	,
0.9190 	,
0.9143 	,
0.8905 	,
0.8952 	,
0.8619 	,
0.8810 	,
0.7810 	,
0.7333 	,  ]
    },
    ## Glass
    "Dataset 5": {
        "GBkNN":     [0.4335, 0.3576 	,
0.3699 	,
0.3368 	,
0.3374 	,
0.3379 	,
0.2775 	,
0.2621 	,
0.2955 	,  ],
        "ACC-GBkNN": [0.6948, 0.6742 	,
0.6807 	,
0.6242 	,
0.6097 	,
0.5816 	,
0.5823 	,
0.5117 	,
0.4606 	, ],
        "ADP-GBkNN": [0.7327, 0.7082 	,
0.6848 	,
0.6251 	,
0.6526 	,
0.5580 	,
0.5216 	,
0.5069 	,
0.4695 	,  ],
        "GBkNN++"  : [0.6799, 0.6422 	,
0.6184 	,
0.6279 	,
0.6275 	,
0.5589 	,
0.5543 	,
0.5485 	,
0.4976 	, ],
        "SGBkNN":    [0.7087, 0.6751 	,
0.6329 	,
0.6190 	,
0.5916 	,
0.6045 	,
0.5396 	,
0.4788 	,
0.4781 	,  ]
    },
## audiology
    "Dataset 6": {
        "GBkNN":     [0.8629, 0.8816  , 0.8821  , 0.8566  , 0.8371  , 0.7968  , 0.7145  , 0.6884  , 0.6629  ],
        "ACC-GBkNN": [0.8624, 0.8671  , 0.8616  , 0.8266  , 0.8318  , 0.7308  , 0.6671  , 0.5608  , 0.5705  ],
        "ADP-GBkNN": [0.8574, 0.7913  , 0.8011  , 0.7403  , 0.7921  , 0.6784  , 0.7087  , 0.5358  , 0.5900  ],
        "GBkNN++"  : [0.8844, 0.8933, 0.8941,   0.8405,   0.7830,   0.7217,   0.7739,   0.6375,   0.6372],
        "SGBkNN":    [0.8932, 0.8918  , 0.8879  , 0.8516  , 0.8984  , 0.8463  , 0.7597  , 0.8003  , 0.7145  ]
    },
    ## ecoli
    "Dataset 7": {
        "GBkNN":     [0.4561, 0.5178  , 0.4671  , 0.4345  , 0.4540  , 0.3781  , 0.4373  , 0.3491  , 0.4164  ],
        "ACC-GBkNN": [0.8454, 0.8215  , 0.8187  , 0.7291  , 0.7026  , 0.6369  , 0.6398  , 0.5683  , 0.5444  ],
        "ADP-GBkNN": [0.8307, 0.7766  , 0.7502  , 0.6963  , 0.6431  , 0.6454  , 0.5833  , 0.5571  , 0.5175  ],
        "GBkNN++"  : [0.8507, 0.8718, 0.8150, 0.8270, 0.8029, 0.7883, 0.7558, 0.7588, 0.7354 ],
        "SGBkNN":    [0.8662, 0.8393  , 0.8337  , 0.8216  , 0.8127  , 0.7918  , 0.7889  , 0.7559  , 0.7657  ]
    },
    ## wdbc
    "Dataset 8": {
        "GBkNN":     [0.9192, 0.9070  , 0.8715  , 0.8735  , 0.8155  , 0.7593  , 0.7101  , 0.6838  , 0.6503  ],
        "ACC-GBkNN": [0.9228, 0.9139  , 0.8523  , 0.8699  , 0.8085  , 0.7592  , 0.7153  , 0.6732  , 0.6258  ],
        "ADP-GBkNN": [0.9140, 0.8701  , 0.8276  , 0.8260  , 0.7539  , 0.7223  , 0.6591  , 0.6520  , 0.5923  ],
        "GBkNN++"  : [0.9279, 0.9237,   0.9156, 0.8769, 0.8311, 0.7926, 0.7329, 0.6555, 0.6187],
        "SGBkNN":    [0.9333, 0.9297  , 0.9208  , 0.9052  , 0.9034  , 0.8629  , 0.8384  , 0.7522  , 0.7012  ]
    },
    ## balance scale
    "Dataset 9": {
        "GBkNN":     [0.7651, 0.7584 	,0.7440 	,0.6914 	,0.7104 	,0.6401 	,0.6188 	,0.5355 	,0.5599  ],
        "ACC-GBkNN": [0.8464, 0.8353 	,0.7936 	,0.7713 	,0.7457 	,0.7074 	,0.6847 	,0.6176 	,0.5936 ],
        "ADP-GBkNN": [0.8112, 0.7297 	,0.6930 	,0.6337 	,0.6269 	,0.6016 	,0.5283 	,0.5123 	,0.4800 ],
        "GBkNN++"  : [0.8321, 0.8208 	,0.7999 	,0.7727 	,0.7743 	,0.7442 	,0.6865 	,0.6705 	,0.6080 	,],
        "SGBkNN":    [0.8992, 0.8497  , 0.8032  , 0.7583  , 0.5893  , 0.6984  , 0.4603  ,  0.4603  , 0.4603  ]
    },

    ##breast ori
    "Dataset 10": {
        "GBkNN":     [0.9555, 0.9511 , 0.9466 , 0.9197 , 0.9110 , 0.8619 , 0.8018 , 0.7683 , 0.7016 ],
        "ACC-GBkNN": [0.9377, 0.9444 , 0.9040 , 0.9065 , 0.8709 , 0.8219 , 0.7106 , 0.6927 , 0.6371 ],
        "ADP-GBkNN": [0.9511, 0.9088 , 0.8729 , 0.7973 , 0.7597 , 0.7549 , 0.6572 , 0.5698 , 0.5721 ],
        "GBkNN++"  : [0.9546, 0.9502, 0.9428, 0.9195, 0.8694, 0.8172, 0.7949, 0.7203, 0.6692],
        "SGBkNN":    [0.9599, 0.9533 , 0.9533 , 0.9420 , 0.9511 , 0.9176 , 0.8953 , 0.8508 , 0.7862 ]
    },
    ## Pima Indians Diabetes
    "Dataset 11": {
        "GBkNN":     [0.7237, 0.7005  , 0.6980  , 0.6665  , 0.6485  , 0.6382  , 0.6226  , 0.5808  , 0.5432  ],
        "ACC-GBkNN": [0.7043, 0.6615  , 0.6524  , 0.6340  , 0.6160  , 0.5547  , 0.5716  , 0.5366  , 0.4948  ],
        "ADP-GBkNN": [0.6965, 0.6718  , 0.6406  , 0.6158  , 0.5964  , 0.5703  , 0.5548  , 0.5353  , 0.5249  ],
        "GBkNN++":   [0.7105, 0.7018 ,0.6679 , 0.6458 , 0.6380 , 0.6094 , 0.5963 , 0.5729 , 0.5598 ],
        "SGBkNN":    [0.7303, 0.7201 	,0.6992 	,0.6965 	,0.6811 	,0.6824 	,0.6695 	,0.6237 	,0.5588  ]
    },
   # ## diabetes
   #  "Dataset 11": {
   #      "GBkNN":     [0.7122, 0.6953  , 0.7110  , 0.6862  , 0.6681  , 0.6420  , 0.6224  , 0.5885  , 0.5599  ],
   #      "ACC-GBkNN": [0.6640, 0.6759  , 0.6629  , 0.6497  , 0.6355  , 0.5926  , 0.5782  , 0.5378  , 0.5104  ],
   #      "ADP-GBkNN": [0.6953, 0.6602  , 0.6524  , 0.6198  , 0.6303  , 0.5990  , 0.6053 ,  0.5390  , 0.5509  ],
   #      "SGBkNN":    [0.7161, 0.7163  , 0.7189  , 0.7058  , 0.6733  , 0.6563  , 0.6576  , 0.6225  , 0.5780  ]
   #  },

    ## fourglass
    "Dataset 12": {
        "GBkNN":     [0.9942, 0.9628  , 0.9083  , 0.8759  , 0.8248  , 0.7773  , 0.6949  , 0.6810  , 0.5857  ],
        "ACC-GBkNN": [0.9930, 0.9802  , 0.9281  , 0.8678  , 0.8133  , 0.7530  , 0.6821  , 0.6509  , 0.5603  ],
        "ADP-GBkNN": [0.9733, 0.9895  , 0.9594  , 0.9617  , 0.9026  , 0.8631  , 0.8110  , 0.7890  , 0.6750  ],
        "GBkNN++":   [0.9896 , 0.9919 , 0.9815 , 0.9571 , 0.9281 , 0.8689 , 0.8166 , 0.7853 , 0.6740 ],
        "SGBkNN":    [0.9988, 0.9965  , 0.9884  , 0.9826  , 0.9594  , 0.8967  , 0.8839  , 0.8295  , 0.7320  ]
    },
    ## biodeg
    "Dataset 13": {
        "GBkNN":     [0.8318, 0.7919  , 0.7975  , 0.7691  , 0.7377  , 0.7053  , 0.6503  , 0.5885  , 0.5723  ],
        "ACC-GBkNN": [0.8090, 0.8080  , 0.7899  , 0.7539  , 0.7225  , 0.6988  , 0.6559  , 0.6112  , 0.6008  ],
        "ADP-GBkNN": [0.7995, 0.7510  , 0.7386  , 0.7006  , 0.6864  , 0.6340  , 0.6208  , 0.5628  , 0.5514  ],
        "GBkNN++":   [0.8482, 0.8114 , 0.8047 , 0.7573 , 0.7487 , 0.7204 , 0.6814 , 0.6446 , 0.5973 ],
        "SGBkNN":    [0.8223, 0.8175  , 0.7938  , 0.8005  , 0.7462  , 0.7395  , 0.6967  , 0.6636  , 0.6055  ]
    },
    ## data banknote
    "Dataset 14": {
        "GBkNN":     [0.9874 , 0.9748  , 0.9362  , 0.8918  , 0.8383  , 0.8212  , 0.7582  , 0.6899  , 0.6484  ],
        "ACC-GBkNN": [0.9778 , 0.9881  , 0.9399  , 0.8969  , 0.8361  , 0.7908  , 0.7352  , 0.6669  , 0.6187  ],
        "ADP-GBkNN": [0.9978 , 0.9674  , 0.9355  , 0.8910  , 0.8531  , 0.8256  , 0.7523  , 0.6550  , 0.6365  ],
        "GBkNN++":   [0.9978 , 0.9891 , 0.9708 , 0.9264 , 0.9031 , 0.8776 , 0.8149 , 0.7405 , 0.6713 ],
        "SGBkNN":    [1      , 0.9956  , 0.9852  , 0.9770  , 0.9622  , 0.9495  , 0.8814  , 0.8138  , 0.7308  ]
    },
    ##cardio

    "Dataset 15": {
        "GBkNN":     [0.9808, 0.9753   , 0.9457   , 0.9358   , 0.8957   , 0.8480   , 0.8002   , 0.7448   , 0.6833   ],
        "ACC-GBkNN": [0.9627, 0.9704   , 0.9237   , 0.8853   , 0.8156   , 0.7563   , 0.7048   , 0.6416   , 0.5615   ],
        "ADP-GBkNN": [0.9819, 0.9391   , 0.8836   , 0.8535   , 0.7931   , 0.7365   , 0.7058   , 0.6532   , 0.5922   ],
        "GBkNN++":   [0.9754, 0.9650, 0.9372 , 0.9039 , 0.8465 , 0.8127 , 0.7641 , 0.7099 , 0.6521 ],
        "SGBkNN":    [0.9819, 0.9819   , 0.9748   , 0.9616   , 0.9539   , 0.9297   , 0.9023   , 0.8299   , 0.7552   ]
    },
    # thyroid
    "Dataset 16": {
        "GBkNN":     [0.9746, 0.9850 , 0.9696 , 0.9453 , 0.9141 , 0.8482 , 0.8047 , 0.7396 , 0.6586 ],
        "ACC-GBkNN": [0.9746, 0.9844 , 0.9278 , 0.8602 , 0.8017 , 0.7290 , 0.6786 , 0.6034 , 0.5418 ],
        "ADP-GBkNN": [0.9893, 0.9412 , 0.8900 , 0.8471 , 0.8110 , 0.7421 , 0.7095 , 0.6387 , 0.5935 ],
        "GBkNN++":   [0.9870, 0.9799 , 0.9549 , 0.9250 , 0.8794 , 0.8388 , 0.7651 , 0.7264  ,0.6572 ],
        "SGBkNN":    [0.9904, 0.9891 , 0.9874 , 0.9828 , 0.9748 , 0.9472 , 0.9185 , 0.8570 , 0.7672 ]
    },
    ## rice
    "Dataset 17": {
        "GBkNN":     [0.8769, 0.8530 , 0.8202 , 0.7932 , 0.7488 , 0.7257 , 0.6856 , 0.6465 , 0.5793 ],
        "ACC-GBkNN": [0.8743, 0.8604 , 0.8268 , 0.7990 , 0.7504 , 0.7273 , 0.6908 , 0.6391 , 0.5793 ],
        "ADP-GBkNN": [0.8756, 0.8640 , 0.8373 , 0.8415 , 0.8084 , 0.7769 , 0.7585 , 0.7504 , 0.6871 ],
        "GBkNN++":   [0.8740 , 0.8932, 0.8740, 0.8475, 0.8294, 0.7745, 0.7252, 0.6795 ,0.6147],
        "SGBkNN":    [0.8822, 0.8738 , 0.8682 , 0.8567 , 0.8444 , 0.8210 , 0.7793 , 0.7323 , 0.6344 ]
    },


    # waveform
    "Dataset 18": {
        "GBkNN":     [0.8060, 0.6080 , 0.6796,  0.6666 , 0.6532 , 0.7088 , 0.6250 , 0.6524 , 0.6364 ],
        "ACC-GBkNN": [0.8106, 0.8076 , 0.8022 , 0.7800 , 0.7756 , 0.7458 , 0.7262 , 0.6896 , 0.6546 ],
        "ADP-GBkNN": [0.7772, 0.7480 , 0.7052 , 0.6800 , 0.6536 , 0.6118 , 0.5730 , 0.5602 , 0.5044 ],
        "GBkNN++":   [0.7946 , 0.7836 , 0.7604 , 0.7292  ,0.6972 , 0.6564 , 0.6122 , 0.5766 , 0.5404 ],
        "SGBkNN":    [0.8408, 0.8302 , 0.8090 , 0.7980 , 0.7980 , 0.7710 , 0.7332 , 0.7116 , 0.6688 ]
    },

    # page blocks
    "Dataset 19": {
        "GBkNN":     [0.8741, 0.8505 , 0.8372 , 0.8645 , 0.7157 , 0.6082 , 0.7080 , 0.6429 , 0.5791 ],
        "ACC-GBkNN": [0.9479, 0.9403 , 0.8836 , 0.8476 , 0.7975 , 0.7435 , 0.6994 , 0.6373 , 0.5893 ],
        "ADP-GBkNN": [0.9594, 0.9086 , 0.8594 , 0.8183 , 0.7714 , 0.7230 , 0.6785 , 0.6210 , 0.5826 ],
        "GBkNN++":   [0.9530, 0.9518, 0.9443, 0.9304, 0.9211 ,0.9050, 0.8756 ,0.8339, 0.7932 ],
        "SGBkNN":    [0.9596, 0.9557 , 0.9574 , 0.9542 , 0.9457 , 0.9394 , 0.9307 , 0.9223 , 0.8947 ]
    },
    "Dataset 20": {
        "GBkNN": [0.7775 ,0.7723	,
0.7603	,
0.7508	,
0.7298	,
0.7063	,
0.671	,
0.6391	,
0.5952	,],
        "ACC-GBkNN": [0.7550, 0.7454	,
0.7402	,
0.7166	,
0.706	,
0.6717	,
0.6486	,
0.6284	,
0.5972	,],
        "ADP-GBkNN": [0.7536, 0.7723	,
0.7603	,
0.7508	,
0.7298	,
0.7063	,
0.671	,
0.6391	,
0.5952	,],
        "GBkNN++":   [0.7513,0.7400 	,
0.7160 	,
0.7007 	,
0.6737 	,
0.6417 	,
0.6175 	,
0.5801 	,
0.5578 	],
        "SGBkNN": [0.7728,0.77	,
0.7668	,
0.7604	,
0.7553	,
0.7379	,
0.7162	,
0.6756	,
0.6359	,]
    },
}




fig, axes = plt.subplots(4, 5, figsize=(20, 16))
# fig.suptitle('Accuracy of Four Models under Different Noise Rates on 20 Datasets', fontsize=14)

# 手动设置每个子图下面的数据集名称
dataset_names = [
    "Dataset 1", "Dataset 2", "Dataset 3", "Dataset 4", "Dataset 5",
    "Dataset 6", "Dataset 7", "Dataset 8", "Dataset 9", "Dataset 10",
    "Dataset 11", "Dataset 12", "Dataset 13", "Dataset 14", "Dataset 15",
     "Dataset 16", "Dataset 17", "Dataset 18", "Dataset 19", "Dataset 20",
]

# 绘制每个数据集的子图
for i, (dataset, model_accuracies) in enumerate(accuracies.items()):
    ax = axes[i // 5, i % 5]
    for j, (model, acc) in enumerate(model_accuracies.items()):
        ax.plot(noise_rates, acc, marker=markers[j], color=colors[j], linestyle='dashdot', linewidth=1, label=model, markersize=4)
    ax.set_xlabel('Label noise rate', fontsize=14)
    ax.set_ylabel('Accuracy', fontsize=16)
    ax.grid(True)
    ax.legend(loc='lower left', fontsize=10)  # 为每个子图显示图例，并放在左下角
    ax.set_xticks(noise_rates)  # 设置x轴刻度，确保每个子图都有刻度标记
    ax.tick_params(axis='x', labelsize=12)  # 确保x轴的刻度标签显示清晰
    ax.tick_params(axis='y', labelsize=12)  # 确保x轴的刻度标签显示清晰

    # 在每个子图下方显示手动设置的数据集名称
    ax.text(0.5, -0.2, dataset_names[i], fontsize=16, ha='center', transform=ax.transAxes)

plt.tight_layout(rect=[0, 0, 1, 0.99])
plt.savefig('robust_label_noise.png', dpi=300)
#plt.show()
